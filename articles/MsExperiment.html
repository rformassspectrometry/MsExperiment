<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Managing mass spectrometry experiments • MsExperiment</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Managing mass spectrometry experiments">
<meta property="og:description" content="MsExperiment">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MsExperiment</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/MsExperiment.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/RforMassSpectrometry/MsExperiment/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="MsExperiment_files/header-attrs-2.7/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Managing mass spectrometry experiments</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/RforMassSpectrometry/MsExperiment/blob/master/vignettes/MsExperiment.Rmd" class="external-link"><code>vignettes/MsExperiment.Rmd</code></a></small>
      <div class="hidden name"><code>MsExperiment.Rmd</code></div>

    </div>

    
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><p><strong>Package</strong>: <em><a href="https://bioconductor.org/packages/3.13/MsExperiment" class="external-link">MsExperiment</a></em><br><strong>Authors</strong>: Laurent Gatto [aut, cre] (<a href="https://orcid.org/0000-0002-1520-2268" class="external-link uri">https://orcid.org/0000-0002-1520-2268</a>), Johannes Rainer [aut], Sebastian Gibb [aut]<br><strong>Last modified:</strong> 2021-04-17 09:58:54<br><strong>Compiled</strong>: Sat Apr 17 10:17:21 2021</p>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The goal of the <code>MsExperiment</code> package is the store and handle all data related to a mass spectrometry experiment. In this vignette, we will describe how to create a <code>MsExperiment</code> object and populate it with various types of data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/RforMassSpectrometry/MsExperiment" class="external-link">"MsExperiment"</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="getting-data" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-data" class="anchor"></a>Getting data</h1>
<p>We will use a small subset of the <a href="https://www.ebi.ac.uk/pride/archive/projects/PXD022816" class="external-link">PXD022816</a> project <span class="citation">[@Morgenstern:2020]</span>. The acquisitions correspond to the Pierce Thermo HeLa digestion standard, diluted to 50ng/uL with 97:3 + 0.1% formic acid, and acquired on a QExactive instrument.</p>
<p>Below, we use the <em><a href="https://bioconductor.org/packages/3.13/rpx" class="external-link">rpx</a></em> package to access the project from the PRIDE repository, and download files of interest. Note that these will automatically be cached in the <code>rpx</code> packages’ cache directory.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/lgatto/rpx" class="external-link">"rpx"</a></span><span class="op">)</span>
<span class="va">px</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpx/man/PXDataset-class.html" class="external-link">PXDataset</a></span><span class="op">(</span><span class="st">"PXD022816"</span><span class="op">)</span>
<span class="va">px</span></code></pre></div>
<pre><code>## Object of class "PXDataset"
##  Id: PXD022816 with 32 files
##  [1] 'QEP2LC6_HeLa_50ng_251120_01-calib.mzID.gz' ... [32] 'checksum.txt'
##  Use 'pxfiles(.)' to see all files.</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/rpx/man/PXDataset-class.html" class="external-link">pxfiles</a></span><span class="op">(</span><span class="va">px</span><span class="op">)</span></code></pre></div>
<pre><code>##  [1] "QEP2LC6_HeLa_50ng_251120_01-calib.mzID.gz"
##  [2] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML"   
##  [3] "QEP2LC6_HeLa_50ng_251120_01.raw"          
##  [4] "QEP2LC6_HeLa_50ng_251120_02-calib.mzID.gz"
##  [5] "QEP2LC6_HeLa_50ng_251120_02-calib.mzML"   
##  [6] "QEP2LC6_HeLa_50ng_251120_02.raw"          
##  [7] "QEP2LC6_HeLa_50ng_251120_03-calib.mzID.gz"
##  [8] "QEP2LC6_HeLa_50ng_251120_03-calib.mzML"   
##  [9] "QEP2LC6_HeLa_50ng_251120_03.raw"          
## [10] "QEP2LC6_HeLa_50ng_251120_04-calib.mzID.gz"
## [11] "QEP2LC6_HeLa_50ng_251120_04-calib.mzML"   
## [12] "QEP2LC6_HeLa_50ng_251120_04.raw"          
## [13] "QEP2LC6_HeLa_50ng_251120_05-calib.mzID.gz"
## [14] "QEP2LC6_HeLa_50ng_251120_05-calib.mzML"   
## [15] "QEP2LC6_HeLa_50ng_251120_05.raw"          
## [16] "QEP2LC6_HeLa_50ng_251120_06-calib.mzID.gz"
## [17] "QEP2LC6_HeLa_50ng_251120_06-calib.mzML"   
## [18] "QEP2LC6_HeLa_50ng_251120_06.raw"          
## [19] "QEP2LC6_HeLa_50ng_251120_07-calib.mzID.gz"
## [20] "QEP2LC6_HeLa_50ng_251120_07-calib.mzML"   
## [21] "QEP2LC6_HeLa_50ng_251120_07.raw"          
## [22] "QEP2LC6_HeLa_50ng_251120_08-calib.mzID.gz"
## [23] "QEP2LC6_HeLa_50ng_251120_08-calib.mzML"   
## [24] "QEP2LC6_HeLa_50ng_251120_08.raw"          
## [25] "QEP2LC6_HeLa_50ng_251120_09-calib.mzID.gz"
## [26] "QEP2LC6_HeLa_50ng_251120_09-calib.mzML"   
## [27] "QEP2LC6_HeLa_50ng_251120_09.raw"          
## [28] "QEP2LC6_HeLa_50ng_251120_10-calib.mzID.gz"
## [29] "QEP2LC6_HeLa_50ng_251120_10-calib.mzML"   
## [30] "QEP2LC6_HeLa_50ng_251120_10.raw"          
## [31] "README.txt"                               
## [32] "checksum.txt"</code></pre>
<p>The project provides the vendor raw files, the converted mzML files as well as the identification mzid files. Let’s download fractions 1 and 2 of the mzML files.</p>
<p>If you run these commands interactively and it’s the first time you use <code><a href="https://rdrr.io/pkg/rpx/man/PXDataset-class.html" class="external-link">pxget()</a></code>, you will be asked to create the <code>rpx</code> cache directory - you can safelfy answer <em>yes</em>. The files will then be downloaded. Next time you want to get the same files, they will be loaded automatically from cache.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">i</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">".+0[12].+mzML$"</span>, <span class="fu"><a href="https://rdrr.io/pkg/rpx/man/PXDataset-class.html" class="external-link">pxfiles</a></span><span class="op">(</span><span class="va">px</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "QEP2LC6_HeLa_50ng_251120_01-calib.mzML"
## [2] "QEP2LC6_HeLa_50ng_251120_02-calib.mzML"</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rpx/man/PXDataset-class.html" class="external-link">pxget</a></span><span class="op">(</span><span class="va">px</span>, <span class="va">i</span><span class="op">)</span></code></pre></div>
<pre><code>## Loading QEP2LC6_HeLa_50ng_251120_01-calib.mzML from cache.</code></pre>
<pre><code>## Loading QEP2LC6_HeLa_50ng_251120_02-calib.mzML from cache.</code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fls</span></code></pre></div>
<pre><code>## [1] "/github/home/.cache/R/rpx/56b714ec8057_QEP2LC6_HeLa_50ng_251120_01-calib.mzML"
## [2] "/github/home/.cache/R/rpx/56b77fc80405_QEP2LC6_HeLa_50ng_251120_02-calib.mzML"</code></pre>
</div>
<div id="ms-experiment-object" class="section level1">
<h1 class="hasAnchor">
<a href="#ms-experiment-object" class="anchor"></a>MS Experiment object</h1>
<p>Let’s start by creating an empty <code>MsExperiment</code> object that we will late populate with different pieces of data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">msexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MsExperiment.html">MsExperiment</a></span><span class="op">(</span><span class="op">)</span>
<span class="va">msexp</span></code></pre></div>
<pre><code>## Object of class MsExperiment</code></pre>
</div>
<div id="experiment-files" class="section level1">
<h1 class="hasAnchor">
<a href="#experiment-files" class="anchor"></a>Experiment files</h1>
<p>Let’s now start with our MS experiment management by saving the relevant files in a dedicated <code>MsExperimentFiles</code> object. In addition to the mzML files, let’s also assume we have the human proteomics fasta files ready. Later, when loading the data, we will refer the the files in this <code>MsExperimentFiles</code> object.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">msfls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MsExperimentFiles.html">MsExperimentFiles</a></span><span class="op">(</span>mzmls <span class="op">=</span> <span class="va">fls</span>,
                           fasta <span class="op">=</span> <span class="st">"homo_sapiens.fasta"</span><span class="op">)</span>
<span class="va">msfls</span></code></pre></div>
<pre><code>## MsExperimentFiles of length  2 
## [["mzmls"]] 56b714ec8057_QEP2LC6_HeLa_50ng_251120_01-calib.mzML ...
## [["fasta"]] homo_sapiens.fasta</code></pre>
<p>Let’s add these files to the main experiment management object:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/MsExperiment.html">experimentFiles</a></span><span class="op">(</span><span class="va">msexp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">msfls</span>
<span class="va">msexp</span></code></pre></div>
<pre><code>## Object of class MsExperiment 
##  Files: mzmls, fasta</code></pre>
</div>
<div id="raw-data" class="section level1">
<h1 class="hasAnchor">
<a href="#raw-data" class="anchor"></a>Raw data</h1>
<p>We can now create a <code>Spectra</code> object containing the raw data stored in the mzML files. If you are not familiar with the <code>Spectra</code> object, please refer to the package vignettes.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu">Spectra</span><span class="op">(</span><span class="fu"><a href="../reference/MsExperiment.html">experimentFiles</a></span><span class="op">(</span><span class="va">msexp</span><span class="op">)</span><span class="op">[[</span><span class="st">"mzmls"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>
<span class="va">sp</span></code></pre></div>
<pre><code>## MSn data (Spectra) with 58907 spectra in a MsBackendMzR backend:
##         msLevel     rtime scanIndex
##       &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;
## 1             1  0.177987         1
## 2             1  0.599870         2
## 3             1  0.978849         3
## 4             1  1.363217         4
## 5             1  1.742965         5
## ...         ...       ...       ...
## 58903         2   4198.59     29328
## 58904         1   4198.74     29329
## 58905         1   4199.11     29330
## 58906         1   4199.49     29331
## 58907         1   4199.87     29332
##  ... 33 more variables/columns.
## 
## file(s):
## 56b714ec8057_QEP2LC6_HeLa_50ng_251120_01-calib.mzML
## 56b77fc80405_QEP2LC6_HeLa_50ng_251120_02-calib.mzML</code></pre>
<p>We can now add these the the main experiment management object:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">spectra</span><span class="op">(</span><span class="va">msexp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">sp</span>
<span class="va">msexp</span></code></pre></div>
<pre><code>## Object of class MsExperiment 
##  Files: mzmls, fasta 
##  Spectra: 1 (12983) 2 (45924)</code></pre>
<div id="third-party-applications" class="section level2">
<h2 class="hasAnchor">
<a href="#third-party-applications" class="anchor"></a>Third party applications</h2>
<p>Let’s now assume we want to search the spectra in our mzML files against the <code>homo_sapiens.fasta</code> file. To do so, we will use a search engine such as MSGF+, that is run using the command line and generates mzid files. Here, for the sake of time and portability, we will not actually run MSGF+, but a simple shell script that will generate mzid files in a temporary R directory.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">outputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"mzML"</span>, <span class="st">"mzid"</span>, <span class="fu"><a href="https://rdrr.io/r/base/basename.html" class="external-link">basename</a></span><span class="op">(</span><span class="fu"><a href="../reference/MsExperiment.html">experimentFiles</a></span><span class="op">(</span><span class="va">msexp</span><span class="op">)</span><span class="op">[[</span><span class="st">"mzmls"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="op">(</span><span class="va">outputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">outputs</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "/tmp/RtmpZvpNGg/56b714ec8057_QEP2LC6_HeLa_50ng_251120_01-calib.mzid"
## [2] "/tmp/RtmpZvpNGg/56b77fc80405_QEP2LC6_HeLa_50ng_251120_02-calib.mzid"</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cmd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"touch"</span>, <span class="va">outputs</span><span class="op">)</span>
<span class="va">cmd</span></code></pre></div>
<pre><code>## [1] "touch /tmp/RtmpZvpNGg/56b714ec8057_QEP2LC6_HeLa_50ng_251120_01-calib.mzid"
## [2] "touch /tmp/RtmpZvpNGg/56b77fc80405_QEP2LC6_HeLa_50ng_251120_02-calib.mzid"</code></pre>
<p>The <code>cmd</code> variable holds the two commands to be run on the command line that will generate the new files. We can run each of these commands with the <code><a href="https://rdrr.io/r/base/system.html" class="external-link">system()</a></code> function.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">cmd</span>, <span class="va">system</span><span class="op">)</span></code></pre></div>
<pre><code>## touch /tmp/RtmpZvpNGg/56b714ec8057_QEP2LC6_HeLa_50ng_251120_01-calib.mzid 
##                                                                         0 
## touch /tmp/RtmpZvpNGg/56b77fc80405_QEP2LC6_HeLa_50ng_251120_02-calib.mzid 
##                                                                         0</code></pre>
<p>Below, we recover the names of the created files (that are identical to those in the <code>outputs</code> variable above) and add these files names to our experiment.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">mzids</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">dir</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, pattern <span class="op">=</span> <span class="st">"mzid$"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "/tmp/RtmpZvpNGg/56b714ec8057_QEP2LC6_HeLa_50ng_251120_01-calib.mzid"
## [2] "/tmp/RtmpZvpNGg/56b77fc80405_QEP2LC6_HeLa_50ng_251120_02-calib.mzid"</code></pre>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/MsExperiment.html">experimentFiles</a></span><span class="op">(</span><span class="va">msexp</span><span class="op">)</span><span class="op">[[</span><span class="st">"mzids"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">mzids</span>
<span class="fu"><a href="../reference/MsExperiment.html">experimentFiles</a></span><span class="op">(</span><span class="va">msexp</span><span class="op">)</span></code></pre></div>
<pre><code>## MsExperimentFiles of length  3 
## [["mzmls"]] 56b714ec8057_QEP2LC6_HeLa_50ng_251120_01-calib.mzML ...
## [["fasta"]] homo_sapiens.fasta
## [["mzids"]] 56b714ec8057_QEP2LC6_HeLa_50ng_251120_01-calib.mzid ...</code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">msexp</span></code></pre></div>
<pre><code>## Object of class MsExperiment 
##  Files: mzmls, fasta, mzids 
##  Spectra: 1 (12983) 2 (45924)</code></pre>
<p>We can also decide to store the commands that were used to generate the mzid files in the experiment files’ metadata slot. Here, we use the convertion to name that metadata item <code>"mzmls_to_mzids"</code> to document to input and output of these commands.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">metadata</span><span class="op">(</span><span class="fu"><a href="../reference/MsExperiment.html">experimentFiles</a></span><span class="op">(</span><span class="va">msexp</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="st">"mzmls_to_mzids"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">cmd</span>
<span class="fu">metadata</span><span class="op">(</span><span class="fu"><a href="../reference/MsExperiment.html">experimentFiles</a></span><span class="op">(</span><span class="va">msexp</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## $mzmls_to_mzids
## [1] "touch /tmp/RtmpZvpNGg/56b714ec8057_QEP2LC6_HeLa_50ng_251120_01-calib.mzid"
## [2] "touch /tmp/RtmpZvpNGg/56b77fc80405_QEP2LC6_HeLa_50ng_251120_02-calib.mzid"</code></pre>
</div>
</div>
<div id="conclusions" class="section level1">
<h1 class="hasAnchor">
<a href="#conclusions" class="anchor"></a>Conclusions</h1>
<p>The <code>MsExperiment</code> object has been used to store files and data pertaining to a mass spectrometry experiment. It is now possible to save that object and reload it later to recover all data and metadata.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span><span class="va">msexp</span>, <span class="st">"msexp.rda"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span>list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ls.html" class="external-link">ls</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">msexp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"msexp.rda"</span><span class="op">)</span>
<span class="va">msexp</span></code></pre></div>
<pre><code>## Object of class MsExperiment 
##  Files: mzmls, fasta, mzids 
##  Spectra: 1 (12983) 2 (45924)</code></pre>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/MsExperiment.html">experimentFiles</a></span><span class="op">(</span><span class="va">msexp</span><span class="op">)</span></code></pre></div>
<pre><code>## MsExperimentFiles of length  3 
## [["mzmls"]] 56b714ec8057_QEP2LC6_HeLa_50ng_251120_01-calib.mzML ...
## [["fasta"]] homo_sapiens.fasta
## [["mzids"]] 56b714ec8057_QEP2LC6_HeLa_50ng_251120_01-calib.mzid ...</code></pre>
<p>We can access the raw data as long as the mzML files that were used to generate it still exist in their original location, which is the case here as they were saved in the <code>rpx</code> cache directory.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu">spectra</span><span class="op">(</span><span class="va">msexp</span><span class="op">)</span>
<span class="va">sp</span></code></pre></div>
<pre><code>## MSn data (Spectra) with 58907 spectra in a MsBackendMzR backend:
##         msLevel     rtime scanIndex
##       &lt;integer&gt; &lt;numeric&gt; &lt;integer&gt;
## 1             1  0.177987         1
## 2             1  0.599870         2
## 3             1  0.978849         3
## 4             1  1.363217         4
## 5             1  1.742965         5
## ...         ...       ...       ...
## 58903         2   4198.59     29328
## 58904         1   4198.74     29329
## 58905         1   4199.11     29330
## 58906         1   4199.49     29331
## 58907         1   4199.87     29332
##  ... 33 more variables/columns.
## 
## file(s):
## 56b714ec8057_QEP2LC6_HeLa_50ng_251120_01-calib.mzML
## 56b77fc80405_QEP2LC6_HeLa_50ng_251120_02-calib.mzML</code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">plotSpectra</span><span class="op">(</span><span class="va">sp</span><span class="op">[</span><span class="fl">1000</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p><img src="MsExperiment_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div id="session-information" class="section level1">
<h1 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session information</h1>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## R Under development (unstable) (2021-04-15 r80175)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.2 LTS
## 
## Matrix products: default
## BLAS/LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.8.so
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=C             
##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] parallel  stats4    stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
## [1] rpx_1.99.6          MsExperiment_0.3.0  Spectra_1.1.18     
## [4] BiocParallel_1.25.5 S4Vectors_0.29.15   BiocGenerics_0.37.1
## [7] ProtGenerics_1.23.9 BiocStyle_2.19.2   
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.6           assertthat_0.2.1     rprojroot_2.0.2     
##  [4] digest_0.6.27        utf8_1.2.1           BiocFileCache_1.99.5
##  [7] R6_2.5.0             RSQLite_2.2.6        evaluate_0.14       
## [10] highr_0.9            httr_1.4.2           pillar_1.6.0        
## [13] rlang_0.4.10         curl_4.3             jquerylib_0.1.3     
## [16] blob_1.2.1           mzR_2.25.3           rmarkdown_2.7       
## [19] pkgdown_1.6.1.9001   textshaping_0.3.3    desc_1.3.0          
## [22] stringr_1.4.0        RCurl_1.98-1.3       bit_4.0.4           
## [25] compiler_4.1.0       xfun_0.22            pkgconfig_2.0.3     
## [28] systemfonts_1.0.1    htmltools_0.5.1.1    tidyselect_1.1.0    
## [31] tibble_3.1.0         bookdown_0.21        codetools_0.2-18    
## [34] IRanges_2.25.8       fansi_0.4.2          withr_2.4.1         
## [37] crayon_1.4.1         dplyr_1.0.5          dbplyr_2.1.1        
## [40] bitops_1.0-6         rappdirs_0.3.3       MASS_7.3-53.1       
## [43] jsonlite_1.7.2       lifecycle_1.0.0      DBI_1.1.1           
## [46] magrittr_2.0.1       MsCoreUtils_1.3.3    ncdf4_1.17          
## [49] stringi_1.5.3        cachem_1.0.4         fs_1.5.0            
## [52] xml2_1.3.2           bslib_0.2.4          filelock_1.0.2      
## [55] ellipsis_0.3.1       ragg_1.1.2           generics_0.1.0      
## [58] vctrs_0.3.7          tools_4.1.0          bit64_4.0.5         
## [61] Biobase_2.51.0       glue_1.4.2           purrr_0.3.4         
## [64] fastmap_1.1.0        yaml_2.2.1           clue_0.3-59         
## [67] cluster_2.1.1        BiocManager_1.30.12  memoise_2.0.0       
## [70] knitr_1.32           sass_0.3.1</code></pre>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Laurent Gatto, Johannes Rainer, Sebastian Gibb.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
